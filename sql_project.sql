-- üìÅ –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∫–ª–∏–µ–Ω—Ç–æ–≤
CREATE TABLE customers (
  customer_id INTEGER PRIMARY KEY,       -- –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –∫–ª–∏–µ–Ω—Ç–∞
  customer_name TEXT                     -- –ò–º—è –∫–ª–∏–µ–Ω—Ç–∞
);

-- üìÅ –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∑–∞–∫–∞–∑–æ–≤
CREATE TABLE orders (
  order_id INTEGER PRIMARY KEY,          -- –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞
  customer_id INTEGER,                   -- –í–Ω–µ—à–Ω–∏–π –∫–ª—é—á: ID –∫–ª–∏–µ–Ω—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π —Å–¥–µ–ª–∞–ª –∑–∞–∫–∞–∑
  order_date DATE,                       -- –î–∞—Ç–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞
  total_amount DECIMAL,                  -- –û–±—â–∞—è —Å—É–º–º–∞ –∑–∞–∫–∞–∑–∞
  FOREIGN KEY (customer_id) REFERENCES customers(customer_id)  -- –°–≤—è–∑—å —Å —Ç–∞–±–ª–∏—Ü–µ–π –∫–ª–∏–µ–Ω—Ç–æ–≤
);

-- üìÅ –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–∫–∞–∑–∞—Ö
CREATE TABLE order_items (
  item_id INTEGER PRIMARY KEY,           -- –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID —Å—Ç—Ä–æ–∫–∏ —Å —Ç–æ–≤–∞—Ä–æ–º –≤ –∑–∞–∫–∞–∑–µ
  order_id INTEGER,                      -- –í–Ω–µ—à–Ω–∏–π –∫–ª—é—á: ID –∑–∞–∫–∞–∑–∞
  product_name TEXT,                     -- –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
  category TEXT,                         -- –ö–∞—Ç–µ–≥–æ—Ä–∏—è —Ç–æ–≤–∞—Ä–∞
  quantity INTEGER,                      -- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –µ–¥–∏–Ω–∏—Ü —Ç–æ–≤–∞—Ä–∞
  price DECIMAL,                         -- –¶–µ–Ω–∞ –∑–∞ –æ–¥–Ω—É –µ–¥–∏–Ω–∏—Ü—É —Ç–æ–≤–∞—Ä–∞
  FOREIGN KEY (order_id) REFERENCES orders(order_id)  -- –°–≤—è–∑—å —Å —Ç–∞–±–ª–∏—Ü–µ–π –∑–∞–∫–∞–∑–æ–≤
);

-- üì¶ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤
INSERT INTO customers VALUES 
(1, 'Ivan Petrov'),                      -- –ö–ª–∏–µ–Ω—Ç —Å ID 1
(2, 'Anna Ivanova'),                     -- –ö–ª–∏–µ–Ω—Ç —Å ID 2
(3, 'Oleg Sidorov');                     -- –ö–ª–∏–µ–Ω—Ç —Å ID 3

-- üõí –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤
INSERT INTO orders VALUES 
(101, 1, '2024-10-01', 300),             -- –ó–∞–∫–∞–∑ ‚Ññ101 –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ 1
(102, 2, '2024-10-01', 450),             -- –ó–∞–∫–∞–∑ ‚Ññ102 –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ 2
(103, 1, '2024-10-02', 150),             -- –ó–∞–∫–∞–∑ ‚Ññ103 –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ 1
(104, 3, '2024-10-03', 500);             -- –ó–∞–∫–∞–∑ ‚Ññ104 –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ 3

-- üßæ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤ –≤ –∑–∞–∫–∞–∑—ã
INSERT INTO order_items VALUES
(1, 101, 'Keyboard', 'Electronics', 1, 100),    -- –í –∑–∞–∫–∞–∑–µ 101: 1 –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ –ø–æ 100
(2, 101, 'Mouse', 'Electronics', 2, 100),       -- –í –∑–∞–∫–∞–∑–µ 101: 2 –º—ã—à–∫–∏ –ø–æ 100
(3, 102, 'Headphones', 'Electronics', 3, 150),  -- –í –∑–∞–∫–∞–∑–µ 102: 3 –Ω–∞—É—à–Ω–∏–∫–∞ –ø–æ 150
(4, 103, 'Mouse', 'Electronics', 1, 150),       -- –í –∑–∞–∫–∞–∑–µ 103: 1 –º—ã—à—å –ø–æ 150
(5, 104, 'Monitor', 'Electronics', 2, 250);     -- –í –∑–∞–∫–∞–∑–µ 104: 2 –º–æ–Ω–∏—Ç–æ—Ä–∞ –ø–æ 250


























-- üìå 1. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –ø–æ –∫–∞–∂–¥–æ–º—É –∫–ª–∏–µ–Ω—Ç—É
-- –û–±—ä–µ–¥–∏–Ω—è–µ–º —Ç–∞–±–ª–∏—Ü—ã –∫–ª–∏–µ–Ω—Ç–æ–≤ –∏ –∑–∞–∫–∞–∑–æ–≤, –∑–∞—Ç–µ–º —Å—á–∏—Ç–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –ø–æ –∫–∞–∂–¥–æ–º—É –∫–ª–∏–µ–Ω—Ç—É

SELECT 
  c.customer_name,                 -- –ò–º—è –∫–ª–∏–µ–Ω—Ç–∞
  COUNT(o.order_id) AS count_order -- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id -- –°–≤—è–∑—å –∑–∞–∫–∞–∑–æ–≤ —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏
GROUP BY c.customer_name;                       -- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∏–º–µ–Ω–∏ –∫–ª–∏–µ–Ω—Ç–∞

-- üìå –ü–æ—è—Å–Ω–µ–Ω–∏–µ: JOIN –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —Ç–∞–±–ª–∏—Ü—ã, –∞ COUNT –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞.


-- üìå 2. –í—ã—Ä—É—á–∫–∞ –ø–æ –∫–∞–∂–¥–æ–º—É –ø—Ä–æ–¥—É–∫—Ç—É
-- –°—á–∏—Ç–∞–µ–º –æ–±—â—É—é –≤—ã—Ä—É—á–∫—É –ø–æ –∫–∞–∂–¥–æ–º—É —Ç–æ–≤–∞—Ä—É = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ √ó —Ü–µ–Ω–∞

SELECT 
  product_name, 
  SUM(quantity * price) AS revenue  -- –û–±—â–∞—è –≤—ã—Ä—É—á–∫–∞ –ø–æ –ø—Ä–æ–¥—É–∫—Ç—É
FROM order_items
GROUP BY product_name               -- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é —Ç–æ–≤–∞—Ä–∞
ORDER BY revenue DESC;              -- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ –≤—ã—Ä—É—á–∫–µ (–ø–æ —É–±—ã–≤–∞–Ω–∏—é)

-- üìå –ü–æ—è—Å–Ω–µ–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑—É–µ–º SUM() –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –≤—ã—Ä—É—á–∫–∏ –ø–æ –∫–∞–∂–¥–æ–º—É —Ç–æ–≤–∞—Ä—É.


-- üìå 3. –°—Ä–µ–¥–Ω–∏–π —á–µ–∫ –ø–æ –∫–∞–∂–¥–æ–º—É –∫–ª–∏–µ–Ω—Ç—É
-- –í—ã—á–∏—Å–ª—è–µ–º —Å—Ä–µ–¥–Ω—é—é —Å—É–º–º—É –∑–∞–∫–∞–∑–æ–≤ (—á–µ–∫) –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞

SELECT 
  c.customer_name, 
  AVG(o.total_amount) AS avg_check  -- –°—Ä–µ–¥–Ω—è—è —Å—É–º–º–∞ –∑–∞–∫–∞–∑–æ–≤
FROM customers c
JOIN orders o ON c.customer_id = o.customer_id -- –°–≤—è–∑—ã–≤–∞–µ–º –∫–ª–∏–µ–Ω—Ç–æ–≤ —Å –∏—Ö –∑–∞–∫–∞–∑–∞–º–∏
GROUP BY c.customer_name;                       -- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –∫–ª–∏–µ–Ω—Ç—É

-- üìå –ü–æ—è—Å–Ω–µ–Ω–∏–µ: AVG() –≤—ã—á–∏—Å–ª—è–µ—Ç —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ total_amount –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞.


-- üìå 4. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –ø–æ –¥–∞—Ç–∞–º
-- –°—á–∏—Ç–∞–µ–º, —Å–∫–æ–ª—å–∫–æ –∑–∞–∫–∞–∑–æ–≤ —Å–¥–µ–ª–∞–Ω–æ –≤ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å

SELECT 
  order_date, 
  COUNT(*) AS total_orders         -- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–∫–∞–∑–æ–≤ –Ω–∞ –¥–∞—Ç—É
FROM orders 
GROUP BY order_date               -- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –¥–∞—Ç–µ
ORDER BY total_orders DESC;       -- –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ —É–±—ã–≤–∞–Ω–∏—é –∑–∞–∫–∞–∑–æ–≤

-- üìå –ü–æ—è—Å–Ω–µ–Ω–∏–µ: COUNT(*) –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –∑–∞–∫–∞–∑—ã –ø–æ –∫–∞–∂–¥–æ–π –¥–∞—Ç–µ.


